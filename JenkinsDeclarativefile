pipeline{
    agent any
    tools{
        maven 'maven-3.9.6'
         }
         //CheckoutCode
         stages{
             stage('Checkoutcode'){
                 steps{
   git branch: 'development', changelog: false, credentialsId: '58ee9fff-c7eb-4a8a-afdf-5ef16ed7b243', poll: false, 
url: 'https://github.com/raviuptimecareer/maven-web-application.git'
        }
                 
        }
//Build

stage('Build the Code'){
                 steps{
                sh "mvn clean package"
        }
                 
        }
        //Execute sonarqube Report
        stage('Generate Sonareqube Report'){
            steps{
                sh "mvn clean sonar:sonar"
            }
        }//Upload Artifact into nexus
        stage('Upload Artifact into Nexus'){
            steps{
                sh "mvn clean deploy"
                
            }
        }
        //Deploy App Into App Server
        stage('Deploy App Into App Server'){
            steps{
     sshagent(['ce6b46e3-ba8a-45cb-8146-1644067cd75e']) {
  sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@13.234.232.112:/opt/tomcat9/webapps"
            }
        }
        }
//Email Notification
stage('Email Notification'){
steps{
mail bcc: '', body: '''hi guys...
the declarative pipeline build is complete.
code ready to move deploy
regards
raviakala raveendra''', cc: '', from: '', replyTo: '', subject: 'build done complete', to: 'ravindra.reavikala.1236@gmail.com'
}
}
     }//stages closing
}//pipeline closing
